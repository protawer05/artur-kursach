{"ast":null,"code":"var _jsxFileName = \"/home/gasper/\\u0420\\u0430\\u0431\\u043E\\u0447\\u0438\\u0439 \\u0441\\u0442\\u043E\\u043B/artur-food/frontend/src/components/authModal/AuthModal.jsx\",\n  _s = $RefreshSig$();\nimport React, { useState } from 'react';\nimport { userAPI } from '../../services/api';\nimport s from './authModal.module.scss';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst AuthModal = ({\n  onClose,\n  onLogin\n}) => {\n  _s();\n  const [phone, setPhone] = useState('');\n  const [isLoading, setIsLoading] = useState(false);\n  const handleSubmit = async e => {\n    e.preventDefault();\n    if (!phone.trim()) {\n      alert('Введите номер телефона');\n      return;\n    }\n    setIsLoading(true);\n    try {\n      // Форматируем номер телефона\n      const formattedPhone = phone.replace(/\\D/g, '');\n\n      // Используем ваш API для логина\n      const user = await userAPI.login(formattedPhone);\n\n      // Сохраняем пользователя в localStorage\n      localStorage.setItem('currentUser', JSON.stringify(user));\n      onLogin(user);\n      onClose();\n    } catch (error) {\n      console.error('Ошибка авторизации:', error);\n\n      // Создаем локального пользователя при ошибке API\n      const localUser = {\n        id: Date.now().toString(),\n        phone: phone.replace(/\\D/g, ''),\n        name: 'Новый пользователь',\n        email: '',\n        address: '',\n        createdAt: new Date().toISOString()\n      };\n      localStorage.setItem('currentUser', JSON.stringify(localUser));\n      onLogin(localUser);\n      onClose();\n    } finally {\n      setIsLoading(false);\n    }\n  };\n  const formatPhone = value => {\n    const numbers = value.replace(/\\D/g, '');\n    if (numbers.length <= 1) return numbers;\n    if (numbers.length <= 4) return `+7 (${numbers.slice(1, 4)}`;\n    if (numbers.length <= 7) return `+7 (${numbers.slice(1, 4)}) ${numbers.slice(4, 7)}`;\n    if (numbers.length <= 9) return `+7 (${numbers.slice(1, 4)}) ${numbers.slice(4, 7)}-${numbers.slice(7, 9)}`;\n    return `+7 (${numbers.slice(1, 4)}) ${numbers.slice(4, 7)}-${numbers.slice(7, 9)}-${numbers.slice(9, 11)}`;\n  };\n  const handlePhoneChange = e => {\n    const formatted = formatPhone(e.target.value);\n    setPhone(formatted);\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: s.modalOverlay,\n    onClick: onClose,\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: s.modalContent,\n      onClick: e => e.stopPropagation(),\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: s.modalHeader,\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          children: \"\\u0412\\u0445\\u043E\\u0434 \\u0432 \\u0430\\u043A\\u043A\\u0430\\u0443\\u043D\\u0442\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 77,\n          columnNumber: 6\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: s.closeBtn,\n          onClick: onClose,\n          children: \"\\xD7\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 78,\n          columnNumber: 6\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 76,\n        columnNumber: 5\n      }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n        onSubmit: handleSubmit,\n        className: s.authForm,\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: s.formGroup,\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            children: \"\\u041D\\u043E\\u043C\\u0435\\u0440 \\u0442\\u0435\\u043B\\u0435\\u0444\\u043E\\u043D\\u0430\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 85,\n            columnNumber: 7\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"tel\",\n            placeholder: \"+7 (999) 999-99-99\",\n            value: phone,\n            onChange: handlePhoneChange,\n            required: true\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 86,\n            columnNumber: 7\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 84,\n          columnNumber: 6\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: s.authInfo,\n          children: \"\\u0412\\u0432\\u0435\\u0434\\u0438\\u0442\\u0435 \\u0432\\u0430\\u0448 \\u043D\\u043E\\u043C\\u0435\\u0440 \\u0442\\u0435\\u043B\\u0435\\u0444\\u043E\\u043D\\u0430. \\u0415\\u0441\\u043B\\u0438 \\u0432\\u044B \\u043D\\u043E\\u0432\\u044B\\u0439 \\u043F\\u043E\\u043B\\u044C\\u0437\\u043E\\u0432\\u0430\\u0442\\u0435\\u043B\\u044C, \\u043C\\u044B \\u0430\\u0432\\u0442\\u043E\\u043C\\u0430\\u0442\\u0438\\u0447\\u0435\\u0441\\u043A\\u0438 \\u0441\\u043E\\u0437\\u0434\\u0430\\u0434\\u0438\\u043C \\u0434\\u043B\\u044F \\u0432\\u0430\\u0441 \\u0430\\u043A\\u043A\\u0430\\u0443\\u043D\\u0442.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 95,\n          columnNumber: 6\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          type: \"submit\",\n          className: s.submitBtn,\n          disabled: isLoading,\n          children: isLoading ? 'Вход...' : 'Войти'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 100,\n          columnNumber: 6\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 83,\n        columnNumber: 5\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 75,\n      columnNumber: 4\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 74,\n    columnNumber: 3\n  }, this);\n};\n_s(AuthModal, \"dirU/b5aIBOczPvVkIG9EwCDdAc=\");\n_c = AuthModal;\nexport default AuthModal;\nvar _c;\n$RefreshReg$(_c, \"AuthModal\");","map":{"version":3,"names":["React","useState","userAPI","s","jsxDEV","_jsxDEV","AuthModal","onClose","onLogin","_s","phone","setPhone","isLoading","setIsLoading","handleSubmit","e","preventDefault","trim","alert","formattedPhone","replace","user","login","localStorage","setItem","JSON","stringify","error","console","localUser","id","Date","now","toString","name","email","address","createdAt","toISOString","formatPhone","value","numbers","length","slice","handlePhoneChange","formatted","target","className","modalOverlay","onClick","children","modalContent","stopPropagation","modalHeader","fileName","_jsxFileName","lineNumber","columnNumber","closeBtn","onSubmit","authForm","formGroup","type","placeholder","onChange","required","authInfo","submitBtn","disabled","_c","$RefreshReg$"],"sources":["/home/gasper/Рабочий стол/artur-food/frontend/src/components/authModal/AuthModal.jsx"],"sourcesContent":["import React, { useState } from 'react'\nimport { userAPI } from '../../services/api'\nimport s from './authModal.module.scss'\n\nconst AuthModal = ({ onClose, onLogin }) => {\n\tconst [phone, setPhone] = useState('')\n\tconst [isLoading, setIsLoading] = useState(false)\n\n\tconst handleSubmit = async e => {\n\t\te.preventDefault()\n\n\t\tif (!phone.trim()) {\n\t\t\talert('Введите номер телефона')\n\t\t\treturn\n\t\t}\n\n\t\tsetIsLoading(true)\n\n\t\ttry {\n\t\t\t// Форматируем номер телефона\n\t\t\tconst formattedPhone = phone.replace(/\\D/g, '')\n\n\t\t\t// Используем ваш API для логина\n\t\t\tconst user = await userAPI.login(formattedPhone)\n\n\t\t\t// Сохраняем пользователя в localStorage\n\t\t\tlocalStorage.setItem('currentUser', JSON.stringify(user))\n\t\t\tonLogin(user)\n\t\t\tonClose()\n\t\t} catch (error) {\n\t\t\tconsole.error('Ошибка авторизации:', error)\n\n\t\t\t// Создаем локального пользователя при ошибке API\n\t\t\tconst localUser = {\n\t\t\t\tid: Date.now().toString(),\n\t\t\t\tphone: phone.replace(/\\D/g, ''),\n\t\t\t\tname: 'Новый пользователь',\n\t\t\t\temail: '',\n\t\t\t\taddress: '',\n\t\t\t\tcreatedAt: new Date().toISOString(),\n\t\t\t}\n\n\t\t\tlocalStorage.setItem('currentUser', JSON.stringify(localUser))\n\t\t\tonLogin(localUser)\n\t\t\tonClose()\n\t\t} finally {\n\t\t\tsetIsLoading(false)\n\t\t}\n\t}\n\n\tconst formatPhone = value => {\n\t\tconst numbers = value.replace(/\\D/g, '')\n\t\tif (numbers.length <= 1) return numbers\n\t\tif (numbers.length <= 4) return `+7 (${numbers.slice(1, 4)}`\n\t\tif (numbers.length <= 7)\n\t\t\treturn `+7 (${numbers.slice(1, 4)}) ${numbers.slice(4, 7)}`\n\t\tif (numbers.length <= 9)\n\t\t\treturn `+7 (${numbers.slice(1, 4)}) ${numbers.slice(\n\t\t\t\t4,\n\t\t\t\t7\n\t\t\t)}-${numbers.slice(7, 9)}`\n\t\treturn `+7 (${numbers.slice(1, 4)}) ${numbers.slice(4, 7)}-${numbers.slice(\n\t\t\t7,\n\t\t\t9\n\t\t)}-${numbers.slice(9, 11)}`\n\t}\n\n\tconst handlePhoneChange = e => {\n\t\tconst formatted = formatPhone(e.target.value)\n\t\tsetPhone(formatted)\n\t}\n\n\treturn (\n\t\t<div className={s.modalOverlay} onClick={onClose}>\n\t\t\t<div className={s.modalContent} onClick={e => e.stopPropagation()}>\n\t\t\t\t<div className={s.modalHeader}>\n\t\t\t\t\t<h2>Вход в аккаунт</h2>\n\t\t\t\t\t<button className={s.closeBtn} onClick={onClose}>\n\t\t\t\t\t\t×\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\n\t\t\t\t<form onSubmit={handleSubmit} className={s.authForm}>\n\t\t\t\t\t<div className={s.formGroup}>\n\t\t\t\t\t\t<label>Номер телефона</label>\n\t\t\t\t\t\t<input\n\t\t\t\t\t\t\ttype='tel'\n\t\t\t\t\t\t\tplaceholder='+7 (999) 999-99-99'\n\t\t\t\t\t\t\tvalue={phone}\n\t\t\t\t\t\t\tonChange={handlePhoneChange}\n\t\t\t\t\t\t\trequired\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<p className={s.authInfo}>\n\t\t\t\t\t\tВведите ваш номер телефона. Если вы новый пользователь, мы\n\t\t\t\t\t\tавтоматически создадим для вас аккаунт.\n\t\t\t\t\t</p>\n\n\t\t\t\t\t<button type='submit' className={s.submitBtn} disabled={isLoading}>\n\t\t\t\t\t\t{isLoading ? 'Вход...' : 'Войти'}\n\t\t\t\t\t</button>\n\t\t\t\t</form>\n\t\t\t</div>\n\t\t</div>\n\t)\n}\n\nexport default AuthModal\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}