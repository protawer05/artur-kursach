(function(t,e){typeof exports=="object"&&typeof module<"u"?e(exports,require("react"),require("react-dom")):typeof define=="function"&&define.amd?define(["exports","react","react-dom"],e):(t=typeof globalThis<"u"?globalThis:t||self,e(t["ymap3-components"]={},t.React,t.ReactDOM))})(this,function(t,e,Y){"use strict";var p=(n=>(n.CartesianProjection="@yandex/ymaps3-cartesian-projection@0.0.1",n.Clusterer="@yandex/ymaps3-clusterer@0.0.1",n.Controls="@yandex/ymaps3-controls@0.0.1",n.Hint="@yandex/ymaps3-hint@0.0.1",n.Markers="@yandex/ymaps3-markers@0.0.1",n.SphericalMercatorProjection="@yandex/ymaps3-spherical-mercator-projection@0.0.1",n))(p||{});const f=e.createContext({}),C=e.createContext({hint:void 0}),v=({children:n,context:o})=>{const a=e.useContext(o);return e.createElement(C.Provider,{value:a},n)},S=({children:n,hint:o})=>{const{reactify:a,ymaps:M}=e.useContext(f),[c,l]=e.useState(),i=e.useMemo(()=>{if(c){const r=window[p.Hint];return a.module(r).YMapHint}},[c]);return e.useEffect(()=>{if(window[p.Hint]){const r=window[p.Hint];l(a.module(r).YMapHintContext)}else M.import(p.Hint).then(r=>{window[p.Hint]=r,a.module(r)&&l(a.module(r).YMapHintContext)})},[]),!i||!c||!n?e.createElement(e.Fragment,null):e.createElement(i,{hint:o},e.createElement(v,{context:c},n))},w=typeof document<"u"?e.useLayoutEffect:e.useEffect,D=e.forwardRef(({gridSize:n,method:o,...a},M)=>{const{reactify:c,ymaps:l}=e.useContext(f),[i,r]=e.useState(),[m,u]=e.useMemo(()=>{if(i){const y=window[p.Clusterer];return[c.module(y).YMapClusterer,o||c.module(y).clusterByGrid]}return[]},[i]);e.useEffect(()=>{window[p.Clusterer]?r(window[p.Clusterer]):l.import(p.Clusterer).then(y=>{window[p.Clusterer]=y,r(y)})},[]);const d=e.useMemo(()=>{if(u&&n)return u({gridSize:n})},[u,n]);return!m||!d?e.createElement(e.Fragment,null):e.createElement(m,{ref:M,method:d,...a})});class E{constructor(o=""){this.eventTarget=document.appendChild(document.createComment(o))}on(o,a){this.eventTarget.addEventListener(o,a)}once(o,a){this.eventTarget.addEventListener(o,a,{once:!0})}off(o,a){this.eventTarget.removeEventListener(o,a)}emit(o,a){return this.eventTarget.dispatchEvent(new CustomEvent(o,{detail:a}))}}const h=new E("ymaps3-components"),L=async({key:n,lang:o="ru_RU",coordorder:a,mode:M,apiKeys:c})=>new Promise(async(l,i)=>{try{if(window.ymaps3){const r=window.ymaps3;await r.ready;const u=(await r.import("@yandex/ymaps3-reactify")).reactify.bindTo(e,Y);l({ymaps:r,reactify:u})}else{const r=document.createElement("script");document.body.appendChild(r),r.type="text/javascript";const m=new URLSearchParams({apikey:n,lang:o});a&&m.set("coordorder",a),M&&m.set("mode",M),r.src=`https://api-maps.yandex.ru/v3/?${m.toString()}`,r.onload=async()=>{const u=window.ymaps3;await u.ready,c&&u.getDefaultConfig().setApikeys(c);const y=(await u.import("@yandex/ymaps3-reactify")).reactify.bindTo(e,Y);l({ymaps:u,reactify:y})},r.onerror=i}}catch{}}),T=({apiKey:n,lang:o,coordorder:a,mode:M,children:c,onLoad:l,onError:i,apiKeys:r})=>{const[m,u]=e.useState();return w(()=>{L({key:n,lang:o,coordorder:a,mode:M,apiKeys:r}).then(d=>{u(d),l==null||l(d),h.emit("ready")}).catch(d=>{i==null||i(d)})},[]),m?e.createElement(f.Provider,{value:m},c):e.createElement(e.Fragment,null)},H=e.memo(T);function s(n,o){let a;const M=({...c},l)=>{const{reactify:i,ymaps:r}=e.useContext(f),[m,u]=e.useState(!1);return w(()=>{o?window[o]?(u(!0),a=i.module(window[o])[n]):r.import(o).then(d=>{window[o]=d,i.module(d)&&(u(!0),a=i.module(d)[n])}):(a=i.module(r)[n],u(!0))},[]),!a||!m?null:e.createElement(a,{ref:l,...c})};return e.forwardRef(M)}const F=s("YMapGeolocationControl",p.Controls),j=s("YMapZoomControl",p.Controls),b=s("YMapClusterer",p.Clusterer),B=s("YMapDefaultMarker",p.Markers),x=s("YMap"),G=s("YMapTileDataSource"),g=s("ThemeContext"),k=s("YMapControl"),q=s("YMapLayer"),O=s("YMapMarker"),Z=s("YMapDefaultSchemeLayer"),I=s("YMapDefaultFeaturesLayer"),P=s("YMapDefaultSatelliteLayer"),U=s("YMapListener"),A=s("YMapControls"),W=s("YMapControlButton"),_=s("YMapContainer"),$=s("YMapCollection"),J=s("YMapFeature"),Q=s("YMapFeatureDataSource"),V=()=>new Promise(n=>{if(window.ymaps3){const o=window.ymaps3;o.ready.then(()=>n(o))}else h.once("ready",()=>{n(window.ymaps3)})});t.ThemeContext=g,t.YMap=x,t.YMapClusterer=b,t.YMapCollection=$,t.YMapComponentsProvider=H,t.YMapContainer=_,t.YMapControl=k,t.YMapControlButton=W,t.YMapControls=A,t.YMapCustomClusterer=D,t.YMapDefaultFeaturesLayer=I,t.YMapDefaultMarker=B,t.YMapDefaultSatelliteLayer=P,t.YMapDefaultSchemeLayer=Z,t.YMapFeature=J,t.YMapFeatureDataSource=Q,t.YMapGeolocationControl=F,t.YMapHint=S,t.YMapHintContext=C,t.YMapLayer=q,t.YMapListener=U,t.YMapMarker=O,t.YMapTileDataSource=G,t.YMapZoomControl=j,t.getYmaps3ReadyObject=V,Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})});
